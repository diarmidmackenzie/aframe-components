<!DOCTYPE html>
<html>
  <head>
      <script src="https://aframe.io/releases/1.4.1/aframe.min.js"></script>
      <script src="https://cdn.jsdelivr.net/gh/c-frame/physx@latest/dist/physx.min.js"></script>
      <script src="../components/bricks/index.js"></script>
      <script>
        AFRAME.registerComponent('brick-spawner', {
          schema: {
            count: {default: 300},
            delay: {default: 2000},
            rate: {default: 20}
          },
          init() {
            const gap = 1000 / this.data.rate
            for (let ii = 0; ii < this.data.count; ii++) {
              setTimeout(this.createRandomBrick.bind(this), this.data.delay + ii * gap)
            }
          },

          createRandomBrick() {
            WIDTHS = [1, 2]
            DEPTHS = [1, 2, 3, 4, 6, 8]
            HEIGHTS = [1, 3]
            // https://color-term.com/lego-colors/index.html
            COLORS = ['#05131D',
                      '#0055BF',
                      '#237841',
                      '#008F9B',
                      '#C91A09',
                      '#C870A0',
                      '#583927',
                      '#9BA19D',
                      '#6D6E5C',
                      '#B4D2E3',
                      '#4B9F4A',
                      '#55A5AF',
                      '#F2705E',
                      '#FC97AC',
                      '#F2CD37',
                      '#FFFFFF',
                      '#C2DAB8',
                      '#FBE696',
                      '#E4CD9E',
                      '#C9CAE2',
                      '#D4D5C9',
                      '#81007B',
                      '#2032B0',
                      '#FE8A18',
                      '#923978',
                      '#BBE90B',
                      '#958A73',
                      '#E4ADC8',
                      '#AC78BA',
                      '#E1D5ED']

            const randomMember = (array) => {
              const index = Math.floor(Math.random() * array.length)
              return array[index]
            }

            const color = randomMember(COLORS)
            const width = randomMember(WIDTHS)
            const height = randomMember(HEIGHTS)
            const depth = randomMember(DEPTHS)

            const brick = document.createElement('a-brick')
            brick.setAttribute("width", width)
            brick.setAttribute("height", height)
            brick.setAttribute("depth", depth)
            brick.setAttribute("color", color)

            const x = THREE.MathUtils.randFloat(-10, 10)
            const y = THREE.MathUtils.randFloat(500, 700)
            const z = THREE.MathUtils.randFloat(-10, 10)

            brick.setAttribute("position", {x, y, z})

            this.el.appendChild(brick)
          }
        })
      </script>
      <link rel="stylesheet" href="../styles.css">
  </head>
  <body>
    <div class="text-overlay">
        <p>Building with bricks</p>
    </div>
        <a class="code-link"
        target="_blank"
        href="https://github.com/diarmidmackenzie/aframe-components/blob/main/component-usage/bricks.html">
        view code
    </a>
      <a-scene background="color:#88f" stats
               physx="autoLoad: true; delay: 1000; useDefaultScene: false; stats: panel">
        <a-entity position = "0 1 -3" scale="0.01 0.01 0.01" brick-spawner>
            <a-brick width="60" movement="static" depth="60" height="3" color="#4B9F4A" position="0 -50 0">
            </a-brick>
        </a-entity>
      </a-scene>
  </body>
</html>



